{{ define "main" }}
<section class="posts-list">
  <h1 class="section-title">{{ .Title }}</h1>

  {{ if eq .Kind "taxonomy" }}
  <nav class="topic-filters">
    <a href="/posts/" class="topic-pill">All</a>
    {{ range .Site.Taxonomies.tags }}
      {{ $name := .Page.Title }}
      {{ $isActive := eq (lower $name) (lower $.Title) }}
      <a href="{{ .Page.Permalink }}" class="topic-pill{{ if $isActive }} active{{ end }}">{{ $name }}</a>
    {{ end }}
  </nav>
  {{ else if eq .Section "posts" }}
  <nav class="topic-filters">
    <a href="/posts/" class="topic-pill active">All</a>
    {{ range .Site.Taxonomies.tags }}
      {{ $name := .Page.Title }}
      <a href="{{ .Page.Permalink }}" class="topic-pill">{{ $name }}</a>
    {{ end }}
  </nav>
  {{ end }}

  {{ $paginator := .Paginate .Pages }}
  {{ range $paginator.Pages }}
  <article class="post-preview">
    <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "January 2, 2006" }}</time>
    <h2><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
    {{ with .Params.subtitle }}<p class="subtitle">{{ . }}</p>{{ end }}
    <p class="excerpt">{{ .Summary }}</p>
    <a href="{{ .Permalink }}" class="read-more">Continue reading &rarr;</a>
  </article>
  {{ end }}

  {{ if gt $paginator.TotalPages 1 }}
  <nav class="pagination">
    {{ if $paginator.HasPrev }}
      <a href="{{ $paginator.Prev.URL }}" class="prev">&larr; Newer</a>
    {{ end }}
    <span class="page-number">Page {{ $paginator.PageNumber }} of {{ $paginator.TotalPages }}</span>
    {{ if $paginator.HasNext }}
      <a href="{{ $paginator.Next.URL }}" class="next">Older &rarr;</a>
    {{ end }}
  </nav>
  {{ end }}
</section>
{{ end }}
